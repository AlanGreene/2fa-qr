<!DOCTYPE html>
<html lang="en">
<head>
  <base target="_blank">
  <title>2FA QR code generator</title>

  <meta charset="utf-8">
  <meta name="author" content="Stefan Sundin">
  <meta name="description" content="2FA QR code generator">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="icon">
  <link rel="license" href="https://www.gnu.org/licenses/gpl-3.0.html" title="GNU GPL v3 or later">
  <link rel="stylesheet" href="https://netdna.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" integrity="sha384-pdapHxIh7EYuwy6K7iE41uXVxGCXY0sAjBzaElYGJUrzwodck3Lx6IE2lA0rFREo" crossorigin="anonymous">
  <link rel="stylesheet" href="https://netdna.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap-theme.min.css" integrity="sha384-aUGj/X2zp5rLCbBxumKTCw2Z50WgIr1vs/PFN4praOTvYXWlVyh2UtNUU0KAUhAX" crossorigin="anonymous">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:500,400">
  <script src="https://code.jquery.com/jquery-2.1.4.min.js" integrity="sha384-R4/ztc4ZlRqWjqIuvf6RX5yb/v90qNGx6fS48N0tRxiGkqveZETq72KgDVJCp2TC" crossorigin="anonymous"></script>
  <script src="https://cdn.rawgit.com/lrsjng/jquery-qrcode/v0.11.0/dist/jquery.qrcode.min.js" integrity="sha384-XEhB3ncbnXl/jivaHehPfuDCYloM4y9eaNehqnyytrMkobhmlMFnq1YeTgdwb9Oa" crossorigin="anonymous"></script>
<style>
body {
  padding: 0 15px;
  margin-bottom: 100px;
}
a {
  cursor: pointer;
}
.container {
  padding: 0;
}
@media (min-width: 768px) {
  .container {
    max-width: 770px;
  }
}

header {
  margin-top: 25px;
  text-align: center;
}
h1 {
  font-size: 4em;
  font-weight: 700;
  margin-bottom: 0.5em;
}
h2 {
  border: none;
  margin-top: 1em;
  font-size: 1.5em;
  font-weight: 400;
}

#qr {
  padding: 25px;
  text-align: center;
}
#app {
  padding: 10px 20px;
  background-color: #23282d;
  border-top: 3px solid #43474b;
  border-bottom: 3px solid #43474b;
  font-family: 'Roboto', sans-serif;
}
#app_issuer {
  color: #bebebe;
  font-size: large;
}
#app_code {
  color: #f3f3f3;
  font-weight: 500;
  font-size: xx-large;
}
#app_label {
  color: #808080;
  font-size: large;
}
</style>
</head>
<body>
  <header>
    <h1 itemprop="name">2FA QR code generator</h1>
    <h2 itemprop="description">Save your 2FA secrets, then use this to scan them again.</h2>
  </header>

  <div class="container">
    <hr>

    <p>This is a 2FA QR code generator made in JavaScript that helps you make QR codes out of 2FA secrets.</p>

    <hr>

    <p>
      <select class="form-control" id="type">
        <option value="totp">Time based (TOTP)</option>
        <option value="hotp">Counter based (HOTP)</option>
      </select>
    </p>

    <p><input class="form-control" type="search" id="secret" placeholder="Secret &mdash; Required"></p>
    <p><input class="form-control" type="search" id="label" placeholder="Label &mdash; Required"></p>
    <p><input class="form-control" type="search" id="issuer" placeholder="Issuer &mdash; Optional" list="issuers"></p>
    <p><input class="form-control" type="search" id="counter" placeholder="Initial counter &mdash; Defaults to 0" pattern="\d+"></p>
    <p><input class="form-control" type="text" name="uri" id="uri" disabled></p>

    <datalist id="issuers">
      <option>Apple</option>
      <option>AWS</option>
      <option>DreamHost</option>
      <option>Dropbox</option>
      <option>Facebook</option>
      <option>GitHub</option>
      <option>GitLab</option>
      <option>Google</option>
      <option>Heroku</option>
      <option>Yahoo!</option>
    </datalist>

    <hr>

    <div id="qr"></div>

<script>
// make a nice QR code as the favicon
$("#qr").empty().qrcode({
  render: "image",
  text: "stefansundin"
});
$("link[rel=icon]").prop("href", $("#qr img").prop("src"));

function type_changed() {
  var type = $("#type").val();
  if (type == "totp") {
    $("#counter").hide();
  }
  else {
    $("#counter").show();
  }
}
type_changed();
$("select").on("change keyup", type_changed);

function generate() {
  var type = $("#type").val();
  var secret = $("#secret").val().replace(/ /g, '');
  var label = $("#label").val();
  var uri = "otpauth://"+type+"/"+encodeURIComponent(label)+"?secret="+secret;
  var issuer = $("#issuer").val();
  if (issuer) {
    uri += "&issuer="+encodeURIComponent(issuer);
  }
  var counter = $("#counter").val() || "0";
  if (type == "hotp") {
    uri += "&counter="+counter;
  }
  $("#uri").val(uri);
  $("#qr").empty().qrcode({
    text: uri
  });
  $("#app_issuer").text(issuer);
  $("#app_label").text(label);
}
generate();
$("select,input").on("change keyup input", generate);
</script>

    <hr>

    <p>The issuer field does not show up in the Yubico app.</p>
    <p>In Google Authenticator, it will look like this:</p>

    <div id="app">
      <div id="app_issuer">Issuer</div>
      <div id="app_code">123456</div>
      <div id="app_label">Label</div>
    </div>

    <hr>

    <ul>
      <li>Made by <a href="https://stefansundin.github.io/">Stefan Sundin</a>.</li>
      <li>Uses <a href="https://larsjung.de/jquery-qrcode/">jquery-qrcode</a>.</li>
      <li>See <a href="https://github.com/google/google-authenticator/wiki/Key-Uri-Format">the docs</a> for the URI format.</li>
    </ul>
  </div>
</body>
</html>
